// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";

interface IERC20 {
    function balanceOf(address) external view returns (uint256);
}

// https://explorer.phalcon.xyz/tx/eth/0x8a8145ab28b5d2a2e61d74c02c12350731f479b3175893de2014124f998bff32
// https://etherscan.io/address/0xb792FAF099991f96c5dfEf037Ae9f248186D9b30

struct S1 {
    address p1;
    address p2;
    uint24 p3;
    address p4;
    uint256 p5;
    uint256 p6;
    uint160 p7;
}

interface I {
    function propagate(address[] memory, uint256[] memory, bytes[] memory, uint256) external payable;
    function withdraw(uint256) external payable;
}

contract X747d is Test {
    address immutable r = address(this);
    receive() external payable {}

    function setUp() public pure {
        console2.log("0x8a8145ab28b5d2a2e61d74c02c12350731f479b3175893de2014124f998bff32");
    }

    address constant x21e2 = 0x21E23F1B88a37d3B30e7E3ed7626dAE189089Cdc;
    address constant x690b = 0x690B9A9E9aa1C9dB991C7721a92d351Db4FaC990;
    address constant x78ac = 0x78AC2624a2Cd193E8dEfE9F39A9528e8bd4a368c;
    address constant xa68c = 0xa68ccE4D90302B728aD60A0fD7baC7737cD3545F;
    address constant xbb00 = 0x0000000000bb00D4f9acE884C5709eDfcf587E1C;
    address constant xc02a = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;
    address constant xc324 = 0xc324B7984990248D86dfe90edf7E3657De2565bA;
    address constant xcdb8 = 0xCdb88cE83e026046CF3aAFA0650EB5F4EB2F3048;
    address constant xdafe = 0xDAFEA492D9c6733ae3d56b7Ed1ADB60692c98Bc5;
    address constant xdcf0 = 0xDCf026d7FBBFFC1633c79E97a2b4Dae1C374406B;
    address constant xf2f5 = 0xF2f5C73fa04406b1995e397B55c24aB1f3eA726C;

    uint256 t_call = 0;
    uint256 t_morph = 0;

    function test1() public {
        vm.createSelectFork("http://localhost:18545", 16029969); // tx.blockNumber - 1
        // vm.createSelectFork("http://localhost:18545", bytes32(0xd0584b4c4d70de69998e091341bde8ede6f02950f3fc7afeae2968481ee008c9));

        // https://explorer.phalcon.xyz/tx/eth/0xd0584b4c4d70de69998e091341bde8ede6f02950f3fc7afeae2968481ee008c9
        this.xd0584b4c();
        // https://explorer.phalcon.xyz/tx/eth/0x91602c4326d18ee165c1990d12a1c8d6305f742da5b090e72a59842feb512ed0
        this.x91602c43();
        // https://explorer.phalcon.xyz/tx/eth/0x90b0b4ae89374fc9034aee40cb0985f5b5a37e7ab8230863d8928f4071f24693
        this.x90b0b4ae();
        // https://explorer.phalcon.xyz/tx/eth/0x86419d8324e1f4f4515e0792da5a05a5ca38a1906c8cb990414f03e51ed62624
        this.x86419d83();
        // https://explorer.phalcon.xyz/tx/eth/0x6297170be87727450f51b36ff3fc88497c68112244ae9734fbd6d2e393f6acb9
        this.x6297170b();
        // https://explorer.phalcon.xyz/tx/eth/0x3b9768c042f2636155b483e51378afdef714363ec374247c2de117de569c1739
        this.x3b9768c0();
        // https://explorer.phalcon.xyz/tx/eth/0x8a8145ab28b5d2a2e61d74c02c12350731f479b3175893de2014124f998bff32
        morph();
    }

    function test2() public {
        vm.createSelectFork("http://localhost:18545", 16027009); // tx.blockNumber - 1
        // https://explorer.phalcon.xyz/tx/eth/0xd0584b4c4d70de69998e091341bde8ede6f02950f3fc7afeae2968481ee008c9
        this.xd0584b4c();
        vm.warp(1669137863);
        vm.roll(16027013);
        // https://explorer.phalcon.xyz/tx/eth/0x91602c4326d18ee165c1990d12a1c8d6305f742da5b090e72a59842feb512ed0
        this.x91602c43();
        vm.warp(1669137875);
        vm.roll(16027014);
        // https://explorer.phalcon.xyz/tx/eth/0x90b0b4ae89374fc9034aee40cb0985f5b5a37e7ab8230863d8928f4071f24693
        this.x90b0b4ae();
        vm.warp(1669139351);
        vm.roll(16027134);
        // https://explorer.phalcon.xyz/tx/eth/0x86419d8324e1f4f4515e0792da5a05a5ca38a1906c8cb990414f03e51ed62624
        this.x86419d83();
        vm.warp(1669139879);
        vm.roll(16027178);
        // https://explorer.phalcon.xyz/tx/eth/0x6297170be87727450f51b36ff3fc88497c68112244ae9734fbd6d2e393f6acb9
        this.x6297170b();
        vm.warp(1669163039);
        vm.roll(16029094);
        // https://explorer.phalcon.xyz/tx/eth/0x3b9768c042f2636155b483e51378afdef714363ec374247c2de117de569c1739
        this.x3b9768c0();
        vm.warp(1669173551);
        vm.roll(16029969);
        // https://explorer.phalcon.xyz/tx/eth/0x8a8145ab28b5d2a2e61d74c02c12350731f479b3175893de2014124f998bff32
        morph();
    }

    function test3() public {
        vm.createSelectFork("http://localhost:18545", 16029969); // tx.blockNumber - 1

        address RECEIVER = address(this);
        vm.warp(1669173551);
        vm.roll(16029970);
        vm.deal(RECEIVER, 10 ether);
        // https://explorer.phalcon.xyz/tx/eth/0x8a8145ab28b5d2a2e61d74c02c12350731f479b3175893de2014124f998bff32
        morph();
    }

    function x3b9768c0() public {
        X747d(payable(r)).morph();
    }

    function x90b0b4ae() public {
        X747d(payable(r)).morph();
    }

    function x6297170b() public {
        X747d(payable(r)).morph();
    }

    function x86419d83() public {
        X747d(payable(r)).morph();
    }

    function xd0584b4c() public {
        X747d(payable(r)).morph();
    }

    function x91602c43() public {
        X747d(payable(r)).morph();
    }

    function morph() public {
        t_morph++;

        if (t_morph == 1) {
            X747d(payable(r)).call();
            x690b.call{value: 497452267449725640}("");
            address(tx.origin).call{value: 273524842025993221}("");
            return;
        }
        if (t_morph == 2) {
            X747d(payable(r)).call();
            xdafe.call{value: 11492360406192848}("");
            address(tx.origin).call{value: 11687135693471962}("");
            return;
        }
        if (t_morph == 3) {
            X747d(payable(r)).call();
            xdafe.call{value: 11479924664880620}("");
            address(tx.origin).call{value: 11699571434784190}("");
            return;
        }
        if (t_morph == 4) {
            X747d(payable(r)).call();
            xdafe.call{value: 26272119524288300}("");
            address(tx.origin).call{value: 25567825653825173}("");
            return;
        }
        if (t_morph == 5) {
            X747d(payable(r)).call();
            xdafe.call{value: 5676703365359208}("");
            address(tx.origin).call{value: 6323296634640792}("");
            return;
        }
        if (t_morph == 6) {
            X747d(payable(r)).call();
            xf2f5.call{value: 4576282559381201}("");
            address(tx.origin).call{value: 6611069638816059}("");
            return;
        }
        if (t_morph == 7) {
            X747d(payable(r)).call();
            x690b.call{value: 10091424440903924264}("");
            address(tx.origin).call{value: 1833964443133564146}("");
            return;
        }
    }

    function call() public {
        t_call++;

        if (t_call == 1) {
            xbb00.call(
                hex"007eb0d06a0ac9f85a48d5db435f8114449d3c49f400008bd8554f00000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000001220000000000000000000000000000000000000000000000000000000000000124000000000000000000000000000000000000000000000000000000000000000050000000000000000000000007d2768de32b0b80b7a3454c06bdac94a69ddc7a90000000000000000000000007d2768de32b0b80b7a3454c06bdac94a69ddc7a90000000000000000000000007d2768de32b0b80b7a3454c06bdac94a69ddc7a90000000000000000000000007d2768de32b0b80b7a3454c06bdac94a69ddc7a90000000000000000000000007d2768de32b0b80b7a3454c06bdac94a69ddc7a90000000000000000000000000000000000000000000000000000000000000005000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000040f665b50000000000000000000000000000000000000000000000000000000040f665b50000000000000000000000000000000000000000000000000000000040f665b50000000000000000000000000000000000000000000000000000000040f665b50000000000000000000000000000000000000000000000000000000040f665b5000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000380000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000009400000000000000000000000000000000000000000000000000000000000000c2000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000047c40f4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000008301ae4fc9c624d1d396cbdaa1ed877821d7c51100000000000000000000000057e04786e231af3343562c062e0d058f25dace9e00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000002020001000000000000000000000000000000000000000000000000000000000b0201000000000000000000000000000000000000000000000000000000000001020001050000000000000000000000000000000000000000000000000000000000000004000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000d533a949740bb3306d119cc777fa900ba034cd52000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000021eec67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000004c83a7f819a5c37d64b4c5a2f8238ea082fa1f4e00000000000000000000000057e04786e231af3343562c062e0d058f25dace9e00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000001020001640000000000000000000000000000000000000000000000000000000b0201000000000000000000000000000000000000000000000000000000000001020001050000000000000000000000000000000000000000000000000000000000000004000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000d533a949740bb3306d119cc777fa900ba034cd52000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000d46394d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000919fa96e88d67499339577fa202345436bcdaf7900000000000000000000000057e04786e231af3343562c062e0d058f25dace9e00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f56400000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000010200011e0000000000000000000000000000000000000000000000000000000b0201000000000000000000000000000000000000000000000000000000000001020001050000000000000000000000000000000000000000000000000000000000000004000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000d533a949740bb3306d119cc777fa900ba034cd52000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000011c06b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000003da1313ae46132a397d90d95b1424a9a7e3e0fce00000000000000000000000057e04786e231af3343562c062e0d058f25dace9e00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000001020001000000000000000000000000000000000000000000000000000000000b0201000000000000000000000000000000000000000000000000000000000001020001050000000000000000000000000000000000000000000000000000000000000004000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000d533a949740bb3306d119cc777fa900ba034cd52000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000066b0d0f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000058dc5a51fe44589beb22e8ce67720b5bc537800900000000000000000000000057e04786e231af3343562c062e0d058f25dace9e00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000001020001000000000000000000000000000000000000000000000000000000000b0201000000000000000000000000000000000000000000000000000000000001020001050000000000000000000000000000000000000000000000000000000000000004000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000d533a949740bb3306d119cc777fa900ba034cd52000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
            );
            xbb00.call(hex"02");
            return;
        }
        if (t_call == 2) {
            return;
        }
        if (t_call == 3) {
            I(xc02a).withdraw(23179496099664810);
            return;
        }
        if (t_call == 4) {
            return;
        }
        if (t_call == 5) {
            I(xc02a).withdraw(23179496099664810);
            return;
        }
        if (t_call == 6) {
            return;
        }
        if (t_call == 7) {
            I(xc02a).withdraw(51839945178113473);
            return;
        }
        if (t_call == 8) {
            return;
        }
        if (t_call == 9) {
            I(xc02a).withdraw(12000000000000000);
            return;
        }
        if (t_call == 10) {
            return;
        }
        if (t_call == 11) {
            address[] memory arr09 = new address[](3);
            arr09[0] = xc324;
            arr09[1] = xcdb8;
            arr09[2] = xdcf0;
            uint256[] memory arr10 = new uint256[](3);
            arr10[0] = 0;
            arr10[1] = 0;
            arr10[2] = 0;
            bytes[] memory arr11 = new bytes[](3);
            arr11[0] = "";
            arr11[1] = "";
            arr11[2] = "";
            I(x21e2).propagate(arr09, arr10, arr11, 11187352198197260);

            return;
        }
        if (t_call == 12) {
            return;
        }
        if (t_call == 13) {
            xa68c.call(abi.encodeWithSelector(0xef78cabc, x78ac));
            return;
        }
        if (t_call == 14) {
            return;
        }
    }

    fallback() external payable {
        revert("no such function");
    }
}
